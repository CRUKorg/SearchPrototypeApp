!function(global){"use strict";global.app=angular.module("searchPrototypeApp",["ui.router","elasticsearch","ngSanitize","angulartics","angulartics.google.analytics"])}(this),function(){"use strict";app.service("ElasticService",function(esFactory){return esFactory({host:crukSearch.config.host,apiVersion:"2.3",log:"trace"})})}(),function(){"use strict";app.controller("SearchController",["ElasticService","esFactory","$log",function(ElasticService,esFactory,$log){var self=this;self.searchInput=null,self.lastSearch=null,self.page=1,self.resultsPerPage=10,self.error=null,self.results=null,self.executeSearch=function(searchInput){""!==searchInput&&searchInput!=self.lastSearch&&(self.lastSearch=searchInput,self.error=null,ElasticService.search({index:"elasticsearch_index_elasticproto_news",from:(self.page-1)*self.resultsPerPage,size:self.resultsPerPage,body:{query:{multi_match:{type:"phrase",fields:["title","body:value"],query:searchInput}},fields:["title","field_published","field_type","body:value","field_url:url"],highlight:{pre_tags:["<mark>"],post_tags:["</mark>"],encoder:"html",fragment_size:150,number_of_fragments:3,fields:{title:{},"body:value":{}}}}}).then(function(body){$log.log(body),self.error=null,self.page=1,self.results=body.hits.hits},function(error){self.error=error.message,$log.log(error.message)}))}}])}();